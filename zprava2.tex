\documentclass[12pt]{article}
%\usepackage{epsf,epic,eepic,eepicemu}
%\documentstyle[epsf,epic,eepic,eepicemu]{article}
%\usepackage[cp1250]{inputenc}
\usepackage[utf8]{inputenc}
\usepackage[czech, english]{babel}
\usepackage{czech}
\usepackage[T1]{fontenc} 
\usepackage{verbatim}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{lmodern}
\usepackage{float}

\makeindex

\begin{document}
%\oddsidemargin=-5mm \evensidemargin=-5mm \marginparwidth=.08in
%\marginparsep=.01in \marginparpush=5pt \topmargin=-15mm
%\headheight=12pt \headsep=25pt \footheight=12pt \footskip=30pt
%\textheight=25cm \textwidth=17cm \columnsep=2mm \columnseprule=1pt
%\parindent=15pt\parskip=2pt

\begin{center}
\bf Semestrální projekt MI-PAP 2010/2011:\\[5mm]
    Paralelní řadící algoritmy\\[5mm]
    Pavel Benáček\\   
    Tomáš Čejka\\[2mm]
magisterské studijum, FIT ČVUT, Kolejní 550/2, 160 00 Praha 6\\[2mm]
\today
\end{center}
\newpage

\tableofcontents
\listoftables
\newpage
\section{Definice problému a popis sekvenčního algoritmu}
\subsection{Zadání}
Podle zadání semestrální práce je úkolem implementace aspoň tří z následujících
řadících algoritmů: Shearsort, 3D sort, Sudo-lichý Mergesort a Bitonic sort.

Pro řešení jsme si vybrali algoritmy Shearsort, Sudo-lichý Mergesort a Bitonic sort.

Pro účely měření času běhu výsledných programů a porovnání paralelních algoritmů se sekvenčním
řazením jsme si implementovali sekvenční algoritmus Mergesort a ten vzali jako referenční sekvenční
řešení.

Semestrální práce spočívala v implementaci vybraných řadících algoritmů jako sekvenční řešení, paralelní
řešení na počítači se sdílenou pamětí s použítím knihovny OpenMP a následně s využitím technologie CUDA
společnosti NVIDIA\textsuperscript{\tiny{\textregistered}}.

\label{sec:reseni}
\subsection{Řešení}
Algoritmy byly ve své podstatě navrženy tak, aby co nejlépe seděli možnostem a architektuře CUDA. Bylo dbáno na několik základních vlastností. A to:
\begin{itemize}
	\item co největší počet vláken v bloku
	\item co nejvíce nezávislých bloků
	\item minimalizace komunikace do globální paměti
\end{itemize}

Tyto části jsou společné pro všechny algoritmy pro CUDA. Zaručují jistou rychlost a škálovatelnost problému.

\section{Popis paralelního algoritmu a jeho implementace v CUDA}
\subsection{Sudo-lichý mergesort}

\subsection{Bitonic sort}

\subsection{Shearsort}
Vzhledem k možnosti HW v grafickém akcelerátoru jsme zvolili implementaci pomoci even odd transpozition sortu. Toto využívání je možné zejména díky schopnosti vytvořit velký počet vláken v zařízení (a to,že každý prvek v poli má své vlastní vlákno). Při samotné implementaci bylo dbáno na několik základních pravidel. A to pravidla v úvodní části \ref{sec:reseni}.

Po nastartování kernelu se provede nakopírování dat do sdílené paměti. Samotné řazení probíhá ve sdílené paměti a mimo bloková komunikace (výměna) probíhá přez globální paměť (kde komunikaci provádí POUZE prvky na přechodu mezi bloky). 

Samotný shearsort byl implementován jako kernel, tak veškerá část algoritmu běží na GPU. Pro tuto příležitost byl implementován algoritmus synchronizace mezi bloky, který byl popsán v \ref{cud:synblocks}. Tento algoritmus nám umožnil synchronizaci mezi bloky a tak se nemuselo z kernelu vystupovat a provádět synchronizaci bloků v rámci programu hosta.

Program si sám spočítá rozložení matice tak, aby se do globální paměti vlezl celý sloupec 2D matice.


\section{Naměřené výsledky a vyhodnocení}
\subsection{Způsob měření}
Měření bylo prováděno nad daty, které se generovalo pro každý každý problém znova a které samozřejmě do doby běhu algoritmu nebylo započítáno. Měření času bylo prováděno prostředky z CUDA SDK. Pro vyhodnocení jsme zvolili konstatní počet vláken na blok.

\subsection{Naměřené časy}
\subsubsection{Shearsort}
\begin{table}[H]
\begin{center}
\begin{tabular}{|r|r|r|}
\hline Množství dat (2\textsuperscript{n}) & Čas \\ \hline
6 &  0,00191242 \\ \hline
7 &  0,00198106 \\ \hline
8 &  0,00355130 \\ \hline
9 &  0,00360128 \\ \hline
10 & 0,00558307 \\ \hline
11 & 0,01193860 \\ \hline
12 & 0,04350320 \\ \hline
13 & 0,24930300 \\ \hline
14 & 1,28781000 \\ \hline
\end{tabular} 
\end{center}
\caption{Shearsort}
\end{table} 

\subsubsection{Even-Odd Mergesort}
\begin{table}[H]
\begin{center}
\begin{tabular}{|r|r|r|}
\hline Množství dat (2\textsuperscript{n}) & Čas \\ \hline
6       &  0.001378000 \\ \hline
7       &  0.001691000 \\ \hline
8       &  0.002085000 \\ \hline
9       &  0.002512000 \\ \hline
10      &  0.002978000 \\ \hline
11      &  0.003739000 \\ \hline
12      &  0.004578000 \\ \hline
13      &  0.005573000 \\ \hline
14      &  0.006700000 \\ \hline
\end{tabular} 
\end{center}
\caption{Even-Odd Mergesort}
\end{table} 

\subsubsection{Bitonic sort}
\begin{table}[H]
\begin{center}
\begin{tabular}{|r|r|r|}
\hline Množství dat (2\textsuperscript{n}) & Čas \\ \hline
6       &  0.001399000 \\ \hline
7       &  0.001699000 \\ \hline
8       &  0.002082000 \\ \hline
9       &  0.002499000 \\ \hline
10      &  0.002951000 \\ \hline
11      &  0.005144000 \\ \hline
12      &  0.007467000 \\ \hline
13      &  0.009914000 \\ \hline
14      &  0.012502000 \\ \hline
\end{tabular} 
\end{center}
\caption{Bitonic sort}
\end{table} 


\subsection{Vyhodnocení}
\section{Literatura}
\begin{enumerate}
\item \href{https://edux.fit.cvut.cz/courses/MI-PAP}{Stránky předmětu MI-PAP}
\item \href{http://aggregate.org/MAGIC/#GPU SyncBlocks}{\label{cud:synblocks}GPU synblocks}
\end{enumerate}

\end{document}
